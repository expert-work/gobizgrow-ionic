/**
 * @fileoverview added by tsickle
 * Generated from: lib/gallery/gallery.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { FivGalleryToolbar } from './gallery-toolbar/gallery-toolbar.component';
import { IonSlides, DomController, Platform } from '@ionic/angular';
import { FivOverlay } from './../overlay/overlay.component';
import { Component, ViewChild, ElementRef, Renderer2, ContentChildren, QueryList, forwardRef, HostListener, Inject, ChangeDetectorRef, Input, Output, EventEmitter, ViewChildren } from '@angular/core';
import { style, animate, AnimationBuilder, trigger, transition, useAnimation } from '@angular/animations';
import { DOCUMENT } from '@angular/common';
import { FivGalleryImage } from './gallery-image/gallery-image.component';
import { from, Subject, zip, of } from 'rxjs';
import { mergeMap, takeUntil, tap } from 'rxjs/operators';
import { tween, fromTo, getPosition, setPosition, fromToPixels, easeOutSine } from '@fivethree/ngx-rxjs-animations';
import { fade } from '../animations/animations';
import { ImageService } from './image.service';
export class FivGallery {
    /**
     * @param {?} domCtrl
     * @param {?} renderer
     * @param {?} animation
     * @param {?} change
     * @param {?} platform
     * @param {?} imageService
     * @param {?} document
     */
    constructor(domCtrl, renderer, animation, change, platform, imageService, document) {
        this.domCtrl = domCtrl;
        this.renderer = renderer;
        this.animation = animation;
        this.change = change;
        this.platform = platform;
        this.imageService = imageService;
        this.document = document;
        this.activeIndex = 0;
        this.inFullscreen = false;
        this.zoomedIn = false;
        this.controlsVisible = true;
        this.slidesLoaded = false;
        this.morphing = false;
        this.backdrop = false;
        this.backdropColor = '#000000ee';
        this.pagerVisible = true;
        this.ambient = false;
        this.willOpen = new EventEmitter();
        this.willClose = new EventEmitter();
        this.didOpen = new EventEmitter();
        this.didClose = new EventEmitter();
        this.backdropChange = new EventEmitter();
        this.$onDestroy = new Subject();
    }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
        this.updateImagesIndex();
        this.setupToolbars();
        this.subscribeToImageEvents();
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.$onDestroy.next();
    }
    /**
     * @return {?}
     */
    subscribeToImageEvents() {
        from(this.images.map((/**
         * @param {?} image
         * @return {?}
         */
        image => image.click)))
            .pipe(mergeMap((/**
         * @param {?} value
         * @return {?}
         */
        (value) => value)), takeUntil(this.$onDestroy))
            .subscribe((/**
         * @param {?} image
         * @return {?}
         */
        image => {
            this.open(image);
        }));
    }
    /**
     * @return {?}
     */
    updateImagesIndex() {
        this.images.forEach((/**
         * @param {?} img
         * @param {?} i
         * @return {?}
         */
        (img, i) => {
            img.index = i;
        }));
    }
    /**
     * @return {?}
     */
    setupToolbars() {
        this.toolbars.forEach((/**
         * @param {?} toolbar
         * @return {?}
         */
        toolbar => {
            if (toolbar.position === 'top') {
                this.topToolbar = toolbar.content;
            }
            else {
                this.bottomToolbar = toolbar.content;
            }
        }));
    }
    /**
     * @param {?} initial
     * @return {?}
     */
    open(initial) {
        this.willOpen.emit(initial);
        this.activeIndex = initial.index;
        this.morphing = true;
        this.overlay.show(50000);
        this.initialImage = initial;
        this.updateBackdrop(this.activeIndex);
        this.initialImage.originalSrc = initial.src;
        setTimeout((/**
         * @return {?}
         */
        () => {
            //wait a little for ripple
            this.backdrop = true;
            this.showControls();
            this.morphIn();
        }), 300);
    }
    /**
     * @return {?}
     */
    morphIn() {
        this.morphOverlay.show(49999);
        /** @type {?} */
        const f = getPosition(this.initialImage.thumbnail);
        /** @type {?} */
        const t = this.calculateImagePosition();
        /** @type {?} */
        const tweenDone = new Subject();
        tween(easeOutSine, 320)
            .pipe(fromToPixels(this.morphImage, f.top, t.top, 'top'), fromToPixels(this.morphImage, f.left, t.left, 'left'), fromToPixels(this.morphImage, f.height, t.height, 'height'), fromToPixels(this.morphImage, f.width, t.width, 'width'))
            .subscribe({
            complete: (/**
             * @return {?}
             */
            () => {
                tweenDone.next();
            })
        });
        zip(tweenDone, !this.slidesLoaded ? this.slides.ionSlidesDidLoad : of(true))
            .pipe(tap((/**
         * @return {?}
         */
        () => {
            this.morphing = false;
            this.morphOverlay.hide();
            this.didOpen.emit(this.initialImage);
            this.swiper.nativeElement.swiper.on('click', (/**
             * @return {?}
             */
            () => {
                this.handleSingleTap();
            }));
        })), takeUntil(this.$onDestroy))
            .subscribe();
    }
    /**
     * @return {?}
     */
    dismiss() {
        this.close(false);
    }
    /**
     * @param {?=} emit
     * @return {?}
     */
    close(emit = true) {
        if (emit) {
            this.willClose.emit(this.initialImage);
        }
        this.backdrop = false;
        /** @type {?} */
        const sameAsInitial = this.images.toArray()[this.activeIndex].index === this.initialImage.index;
        if (sameAsInitial) {
            this.morphBack();
        }
        else {
            this.slideOut();
        }
        this.resetSlides(0);
        if (this.inFullscreen) {
            this.closeFullscreen();
        }
        this.slidesLoaded = false;
    }
    /**
     * @return {?}
     */
    morphBack() {
        /** @type {?} */
        const f = getPosition(this.getActiveImage());
        /** @type {?} */
        const t = getPosition(this.initialImage.thumbnail);
        this.overlay.hide();
        this.morphOverlay.show();
        tween(easeOutSine, 240)
            .pipe(fromToPixels(this.morphImage, f.top, t.top, 'top'), fromToPixels(this.morphImage, f.left, t.left, 'left'), fromToPixels(this.morphImage, f.height, t.height, 'height'), fromToPixels(this.morphImage, f.width, t.width, 'width'))
            .subscribe({
            complete: (/**
             * @return {?}
             */
            () => {
                this.morphOverlay.hide();
                this.didClose.emit(this.initialImage);
                this.initialImage = null;
            })
        });
    }
    /**
     * @return {?}
     */
    slideOut() {
        this.overlay.hide();
        this.morphOverlay.show();
        this.morphImage.nativeElement.src = this.getActiveImage().nativeElement.src;
        setPosition(this.morphImage, getPosition(this.getActiveImage()));
        tween(easeOutSine, 240)
            .pipe(fromTo(this.morphImage, 'transform', 0, 100, (/**
         * @param {?} t
         * @return {?}
         */
        (t) => `translateY(${t}%)`)))
            .subscribe({
            complete: (/**
             * @return {?}
             */
            () => {
                this.morphImage.nativeElement.style.transform = '';
                this.morphOverlay.hide();
                this.didClose.emit(this.initialImage);
                this.initialImage = null;
            })
        });
    }
    /**
     * @return {?}
     */
    getActiveImage() {
        return this.slideImages.toArray()[this.activeIndex];
    }
    /**
     * @param {?} progress
     * @return {?}
     */
    transformSlides(progress) {
        if (this.controlsVisible) {
            this.hideControls();
        }
        this.domCtrl.write((/**
         * @return {?}
         */
        () => {
            this.renderer.setStyle(this.viewer.nativeElement, 'transform', `translateY(${progress * 120}px)`);
        }));
    }
    /**
     * @param {?} progress
     * @return {?}
     */
    resetSlides(progress) {
        /** @type {?} */
        const reset = this.animation.build([
            style({ transform: `translateY(${progress * 120}px)` }),
            animate('150ms', style({ transform: `translateY(0px)` }))
        ]);
        /** @type {?} */
        const animation = reset.create(this.viewer.nativeElement);
        animation.play();
        animation.onDone((/**
         * @return {?}
         */
        () => {
            animation.destroy();
            this.transformSlides(0);
            this.showControls();
        }));
    }
    /**
     * @return {?}
     */
    slideDidChange() {
        this.activeIndex = this.swiper.nativeElement.swiper.activeIndex;
    }
    /**
     * @return {?}
     */
    ionSlideNextStart() {
        if (this.slidesLoaded) {
            this.updateBackdrop(this.activeIndex + 1);
        }
    }
    /**
     * @return {?}
     */
    ionSlidePrevStart() {
        if (this.slidesLoaded) {
            this.updateBackdrop(this.activeIndex - 1);
        }
    }
    /**
     * @param {?} index
     * @return {?}
     */
    updateBackdrop(index) {
        this.backdropColor = this.ambient
            ? this.imageService.getAverageRGB(this.images.toArray()[index].thumbnail.nativeElement)
            : '#000000ee';
        this.backdropChange.emit();
    }
    /**
     * @return {?}
     */
    onSlidesLoad() {
        this.slidesLoaded = true;
    }
    /**
     * @return {?}
     */
    calculateImagePosition() {
        /** @type {?} */
        const nH = this.initialImage.thumbnail.nativeElement.naturalHeight;
        /** @type {?} */
        const nW = this.initialImage.thumbnail.nativeElement.naturalWidth;
        /** @type {?} */
        let height = Math.min(nH, this.platform.height());
        /** @type {?} */
        let width = Math.min(nW, this.platform.width());
        /** @type {?} */
        const ratio = nW / nH;
        if (ratio * height < width) {
            width = height * ratio;
        }
        else {
            height = width / ratio;
        }
        /** @type {?} */
        const top = this.platform.height() / 2 - height / 2;
        /** @type {?} */
        const left = this.platform.width() / 2 - width / 2;
        /** @type {?} */
        const p = {
            height: height,
            width: width,
            left: left,
            top: top
        };
        return p;
    }
    /**
     * @return {?}
     */
    fullscreen() {
        if (this.inFullscreen) {
            this.closeFullscreen();
        }
        else {
            this.openFullscreen();
        }
    }
    /**
     * @return {?}
     */
    openFullscreen() {
        /** @type {?} */
        const elem = document.documentElement;
        if (elem.requestFullscreen) {
            elem.requestFullscreen();
        }
        else if (elem['mozRequestFullScreen']) {
            /* Firefox */
            elem['mozRequestFullScreen']();
        }
        else if (elem['webkitRequestFullscreen']) {
            /* Chrome, Safari and Opera */
            elem['webkitRequestFullscreen']();
        }
        else if (elem['msRequestFullscreen']) {
            /* IE/Edge */
            elem['msRequestFullscreen']();
        }
        this.inFullscreen = true;
    }
    /**
     * @return {?}
     */
    closeFullscreen() {
        this.inFullscreen = false;
        if (this.document.exitFullscreen) {
            this.document.exitFullscreen();
        }
        else if (this.document.mozCancelFullScreen) {
            /* Firefox */
            this.document.mozCancelFullScreen();
        }
        else if (this.document.webkitExitFullscreen) {
            /* Chrome, Safari and Opera */
            this.document.webkitExitFullscreen();
        }
        else if (this.document.msExitFullscreen) {
            /* IE/Edge */
            this.document.msExitFullscreen();
        }
    }
    /**
     * @return {?}
     */
    zoom() {
        if (this.zoomedIn) {
            this.zoomOut();
        }
        else {
            this.zoomIn();
        }
    }
    /**
     * @return {?}
     */
    zoomIn() {
        this.swiper.nativeElement.swiper.zoom.in();
        this.zoomedIn = true;
    }
    /**
     * @return {?}
     */
    zoomOut() {
        this.swiper.nativeElement.swiper.zoom.out();
        this.zoomedIn = false;
    }
    /**
     * @return {?}
     */
    handleSingleTap() {
        this.controlsVisible = !this.controlsVisible;
        this.change.detectChanges();
    }
    /**
     * @return {?}
     */
    hideControls() {
        this.controlsVisible = false;
        this.change.detectChanges();
    }
    /**
     * @return {?}
     */
    showControls() {
        this.controlsVisible = true;
        this.change.detectChanges();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    keyEvent(event) {
        if (this.slidesLoaded && !this.morphing) {
            this.handleKeyboardEvents(event);
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    handleKeyboardEvents(event) {
        if (event.key === 'ArrowRight') {
            this.next();
            return;
        }
        if (event.key === 'ArrowLeft') {
            this.prev();
            return;
        }
        if (event.key === 'ArrowDown' || event.key === 'Escape') {
            this.close();
            return;
        }
    }
    /**
     * @return {?}
     */
    next() {
        if (this.slides && this.slidesLoaded) {
            this.slides.slideNext();
        }
    }
    /**
     * @return {?}
     */
    prev() {
        if (this.slides && this.slidesLoaded) {
            this.slides.slidePrev();
        }
    }
}
FivGallery.decorators = [
    { type: Component, args: [{
                selector: 'fiv-gallery',
                template: "<ng-content></ng-content>\n<fiv-overlay #overlay>\n  <div [style.background]=\"backdropColor\" [@fade] class=\"backdrop\" *ngIf=\"overlay.open && backdrop\"></div>\n\n  <div [style.visibility]=\"!morphing ? 'visible' : 'hidden'\">\n    <div [@slideDown] *ngIf=\"controlsVisible && topToolbar\" class=\"gallery-toolbar header\" color=\"transparent\">\n      <ng-container [ngTemplateOutlet]=\"topToolbar\">\n      </ng-container>\n    </div>\n\n    <ng-container *fivIf=\"['desktop']\">\n      <ion-fab [@scale] *ngIf=\"controlsVisible && images?.length > 0 && pagerVisible\" vertical=\"center\"\n        horizontal=\"start\" slot=\"fixed\">\n        <ion-fab-button color=\"light\" (click)=\"prev()\" [disabled]=\"activeIndex === 0\">\n          <ion-icon name=\"arrow-back\"></ion-icon>\n        </ion-fab-button>\n      </ion-fab>\n    </ng-container>\n\n    <div #viewer class=\"viewer\" fivPull [maxPullHeight]=\"160\" [minPullHeight]=\"120\" (fivPull)=\"transformSlides($event)\"\n      (fivRefresh)=\"close()\" (fivCancel)=\"resetSlides($event)\" [enableScroll]=\"true\">\n      <ion-slides #slider *ngIf=\"overlay.open\" (ionSlideDidChange)=\"slideDidChange()\"\n        (ionSlideNextStart)=\"ionSlideNextStart()\" (ionSlidePrevStart)=\"ionSlidePrevStart()\"\n        (ionSlidesDidLoad)=\"onSlidesLoad()\" [options]=\"{ zoom: true, initialSlide: initialImage?.index}\">\n        <ion-slide *ngFor=\"let image of images; let i = index\">\n          <div class=\"swiper-zoom-container\">\n            <img #slideImage [ngClass]=\"{'instant': activeIndex !== i}\" [src]=\"image.src\">\n          </div>\n        </ion-slide>\n      </ion-slides>\n    </div>\n\n    <ng-container *fivIf=\"['desktop']\">\n      <ion-fab [@scale] *ngIf=\"controlsVisible && pagerVisible\" vertical=\"center\" horizontal=\"end\" slot=\"fixed\">\n        <ion-fab-button color=\"light\" (click)=\"next()\" [disabled]=\"activeIndex === images.length - 1\">\n          <ion-icon name=\"arrow-forward\"></ion-icon>\n        </ion-fab-button>\n      </ion-fab>\n    </ng-container>\n\n    <div [@slideUp] *ngIf=\"controlsVisible && bottomToolbar\" class=\"gallery-toolbar footer\" color=\"transparent\">\n      <ng-container [ngTemplateOutlet]=\"bottomToolbar\">\n      </ng-container>\n    </div>\n  </div>\n\n\n\n\n</fiv-overlay>\n<fiv-overlay #morphOverlay>\n  <img #morph class=\"morph\" *ngIf=\"initialImage\" [src]=\"initialImage.src\">\n</fiv-overlay>",
                animations: [
                    trigger('scale', [
                        transition('void => *', [
                            style({ opacity: 0, transform: 'scale(0)' }),
                            animate('125ms', style({ opacity: 1, transform: 'scale(1)' }))
                        ]),
                        transition('* => void', [
                            style({ opacity: 1, transform: 'scale(1)' }),
                            animate('125ms', style({ opacity: 0, transform: 'scale(0)' }))
                        ])
                    ]),
                    trigger('slideUp', [
                        transition('void => *', [
                            style({ opacity: 0, transform: 'translateY(100%)' }),
                            animate('75ms', style({ opacity: 1, transform: 'translateY(0%)' }))
                        ]),
                        transition('* => void', [
                            style({ opacity: 1, transform: 'translateY(0%)' }),
                            animate('75ms', style({ opacity: 0, transform: 'translateY(100%)' }))
                        ])
                    ]),
                    trigger('slideDown', [
                        transition('* => void', [
                            style({ opacity: 0, transform: 'translateY(0%)' }),
                            animate('75ms', style({ opacity: 1, transform: 'translateY(-100%)' }))
                        ]),
                        transition('void => *', [
                            style({ opacity: 1, transform: 'translateY(-100%)' }),
                            animate('75ms', style({ opacity: 0, transform: 'translateY(0%)' }))
                        ])
                    ]),
                    trigger('fade', [
                        transition('* => void', useAnimation(fade, {
                            params: {
                                fromOpacity: 1,
                                toOpacity: 0,
                                time: '240ms'
                            }
                        })),
                        transition('void => *', useAnimation(fade, {
                            params: {
                                fromOpacity: 0,
                                toOpacity: 1,
                                time: '240ms'
                            }
                        }))
                    ])
                ],
                styles: [".viewer{width:100vw;height:100vh}.viewer ion-slides{height:100%}.viewer img{height:auto;max-height:100%;width:auto;max-width:100%}.viewer img.instant{transition-duration:0s!important}.gallery-toolbar{width:100%;--fiv-gallery-toolbar-color:#fff;position:absolute;color:var(--fiv-gallery-toolbar-color)}.gallery-toolbar.header{top:env(safe-area-inset-top)}.gallery-toolbar.footer{bottom:env(safe-area-inset-bottom)}.morph{position:absolute;-o-object-position:center;object-position:center;-o-object-fit:cover;object-fit:cover;display:block}.backdrop{height:100vh;width:100vw;position:absolute;transition:background-color .2s}"]
            }] }
];
/** @nocollapse */
FivGallery.ctorParameters = () => [
    { type: DomController },
    { type: Renderer2 },
    { type: AnimationBuilder },
    { type: ChangeDetectorRef },
    { type: Platform },
    { type: ImageService },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
];
FivGallery.propDecorators = {
    overlay: [{ type: ViewChild, args: ['overlay', { static: false },] }],
    morphOverlay: [{ type: ViewChild, args: ['morphOverlay', { static: false },] }],
    viewer: [{ type: ViewChild, args: ['viewer', { static: false },] }],
    morphImage: [{ type: ViewChild, args: ['morph', { static: false },] }],
    swiper: [{ type: ViewChild, args: ['slider', { static: false, read: ElementRef },] }],
    slides: [{ type: ViewChild, args: ['slider', { static: false },] }],
    slideImages: [{ type: ViewChildren, args: ['slideImage',] }],
    images: [{ type: ContentChildren, args: [forwardRef((/**
                 * @return {?}
                 */
                () => FivGalleryImage)),
                { descendants: true },] }],
    toolbars: [{ type: ContentChildren, args: [FivGalleryToolbar,] }],
    pagerVisible: [{ type: Input }],
    ambient: [{ type: Input }],
    willOpen: [{ type: Output }],
    willClose: [{ type: Output }],
    didOpen: [{ type: Output }],
    didClose: [{ type: Output }],
    backdropChange: [{ type: Output }],
    keyEvent: [{ type: HostListener, args: ['window:keyup', ['$event'],] }]
};
if (false) {
    /** @type {?} */
    FivGallery.prototype.overlay;
    /** @type {?} */
    FivGallery.prototype.morphOverlay;
    /** @type {?} */
    FivGallery.prototype.viewer;
    /** @type {?} */
    FivGallery.prototype.morphImage;
    /** @type {?} */
    FivGallery.prototype.swiper;
    /** @type {?} */
    FivGallery.prototype.slides;
    /** @type {?} */
    FivGallery.prototype.slideImages;
    /** @type {?} */
    FivGallery.prototype.images;
    /** @type {?} */
    FivGallery.prototype.toolbars;
    /** @type {?} */
    FivGallery.prototype.topToolbar;
    /** @type {?} */
    FivGallery.prototype.bottomToolbar;
    /** @type {?} */
    FivGallery.prototype.initialImage;
    /** @type {?} */
    FivGallery.prototype.activeIndex;
    /** @type {?} */
    FivGallery.prototype.inFullscreen;
    /** @type {?} */
    FivGallery.prototype.zoomedIn;
    /** @type {?} */
    FivGallery.prototype.controlsVisible;
    /** @type {?} */
    FivGallery.prototype.slidesLoaded;
    /** @type {?} */
    FivGallery.prototype.morphing;
    /** @type {?} */
    FivGallery.prototype.backdrop;
    /** @type {?} */
    FivGallery.prototype.backdropColor;
    /** @type {?} */
    FivGallery.prototype.pagerVisible;
    /** @type {?} */
    FivGallery.prototype.ambient;
    /** @type {?} */
    FivGallery.prototype.willOpen;
    /** @type {?} */
    FivGallery.prototype.willClose;
    /** @type {?} */
    FivGallery.prototype.didOpen;
    /** @type {?} */
    FivGallery.prototype.didClose;
    /** @type {?} */
    FivGallery.prototype.backdropChange;
    /** @type {?} */
    FivGallery.prototype.$onDestroy;
    /**
     * @type {?}
     * @private
     */
    FivGallery.prototype.domCtrl;
    /**
     * @type {?}
     * @private
     */
    FivGallery.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    FivGallery.prototype.animation;
    /**
     * @type {?}
     * @private
     */
    FivGallery.prototype.change;
    /**
     * @type {?}
     * @private
     */
    FivGallery.prototype.platform;
    /**
     * @type {?}
     * @private
     */
    FivGallery.prototype.imageService;
    /**
     * @type {?}
     * @private
     */
    FivGallery.prototype.document;
}
export class Position {
}
if (false) {
    /** @type {?} */
    Position.prototype.top;
    /** @type {?} */
    Position.prototype.left;
    /** @type {?} */
    Position.prototype.height;
    /** @type {?} */
    Position.prototype.width;
    /** @type {?} */
    Position.prototype.translate;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FsbGVyeS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZml2ZXRocmVlL2NvcmUvIiwic291cmNlcyI6WyJsaWIvZ2FsbGVyeS9nYWxsZXJ5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDZDQUE2QyxDQUFDO0FBQ2hGLE9BQU8sRUFBRSxTQUFTLEVBQUUsYUFBYSxFQUFFLFFBQVEsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUM1RCxPQUFPLEVBQ0wsU0FBUyxFQUNULFNBQVMsRUFDVCxVQUFVLEVBQ1YsU0FBUyxFQUNULGVBQWUsRUFDZixTQUFTLEVBRVQsVUFBVSxFQUNWLFlBQVksRUFDWixNQUFNLEVBQ04saUJBQWlCLEVBRWpCLEtBQUssRUFDTCxNQUFNLEVBQ04sWUFBWSxFQUVaLFlBQVksRUFDYixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQ0wsS0FBSyxFQUNMLE9BQU8sRUFDUCxnQkFBZ0IsRUFDaEIsT0FBTyxFQUNQLFVBQVUsRUFDVixZQUFZLEVBQ2IsTUFBTSxxQkFBcUIsQ0FBQztBQUU3QixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFM0MsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBQzFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDOUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDMUQsT0FBTyxFQUNMLEtBQUssRUFDTCxNQUFNLEVBQ04sV0FBVyxFQUNYLFdBQVcsRUFFWCxZQUFZLEVBQ1osV0FBVyxFQUNaLE1BQU0sZ0NBQWdDLENBQUM7QUFDeEMsT0FBTyxF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QUM7Z0JBQ2pDLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRTt1QkFHdEIsZUFBZSxTQUFDLGlCQUFpQjsyQkFnQmpDLEtBQUs7c0JBQ0wsS0FBSzt1QkFFTCxNQUFNO3dCQUNOLE1BQU07c0JBQ04sTUFBTTt1QkFDTixNQUFNOzZCQUNOLE1BQU07dUJBdVVOLFlBQVksU0FBQyxjQUFjLEVBQUUsQ0FBQyxRQUFRLENBQUM7Ozs7SUEzV3hDLDZCQUE2RDs7SUFDN0Qsa0NBQXVFOztJQUN2RSw0QkFBMkQ7O0lBQzNELGdDQUE4RDs7SUFDOUQsNEJBQTZFOztJQUM3RSw0QkFBMEQ7O0lBQzFELGlDQUErRDs7SUFFL0QsNEJBSW1DOztJQUNuQyw4QkFBMkU7O0lBRTNFLGdDQUE2Qjs7SUFDN0IsbUNBQWdDOztJQUdoQyxrQ0FBOEI7O0lBQzlCLGlDQUFnQjs7SUFDaEIsa0NBQXFCOztJQUNyQiw4QkFBaUI7O0lBQ2pCLHFDQUF1Qjs7SUFDdkIsa0NBQXFCOztJQUNyQiw4QkFBaUI7O0lBQ2pCLDhCQUFpQjs7SUFDakIsbUNBQTRCOztJQUU1QixrQ0FBNkI7O0lBQzdCLDZCQUF5Qjs7SUFFekIsOEJBQXlEOztJQUN6RCwrQkFBMEQ7O0lBQzFELDZCQUF3RDs7SUFDeEQsOEJBQXlEOztJQUN6RCxvQ0FBK0Q7O0lBRS9ELGdDQUEyQjs7Ozs7SUFHekIsNkJBQThCOzs7OztJQUM5Qiw4QkFBMkI7Ozs7O0lBQzNCLCtCQUFtQzs7Ozs7SUFDbkMsNEJBQWlDOzs7OztJQUNqQyw4QkFBMEI7Ozs7O0lBQzFCLGtDQUFrQzs7Ozs7SUFDbEMsOEJBQXVDOztBQThWM0MsTUFBTSxPQUFPLFFBQVE7Q0FNcEI7OztJQUxDLHVCQUFZOztJQUNaLHdCQUFhOztJQUNiLDBCQUFlOztJQUNmLHlCQUFjOztJQUNkLDZCQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEZpdkdhbGxlcnlUb29sYmFyIH0gZnJvbSAnLi9nYWxsZXJ5LXRvb2xiYXIvZ2FsbGVyeS10b29sYmFyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBJb25TbGlkZXMsIERvbUNvbnRyb2xsZXIsIFBsYXRmb3JtIH0gZnJvbSAnQGlvbmljL2FuZ3VsYXInO1xuaW1wb3J0IHsgRml2T3ZlcmxheSB9IGZyb20gJy4vLi4vb3ZlcmxheS9vdmVybGF5LmNvbXBvbmVudCc7XG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIFZpZXdDaGlsZCxcbiAgRWxlbWVudFJlZixcbiAgUmVuZGVyZXIyLFxuICBDb250ZW50Q2hpbGRyZW4sXG4gIFF1ZXJ5TGlzdCxcbiAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgZm9yd2FyZFJlZixcbiAgSG9zdExpc3RlbmVyLFxuICBJbmplY3QsXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBUZW1wbGF0ZVJlZixcbiAgSW5wdXQsXG4gIE91dHB1dCxcbiAgRXZlbnRFbWl0dGVyLFxuICBPbkRlc3Ryb3ksXG4gIFZpZXdDaGlsZHJlblxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIHN0eWxlLFxuICBhbmltYXRlLFxuICBBbmltYXRpb25CdWlsZGVyLFxuICB0cmlnZ2VyLFxuICB0cmFuc2l0aW9uLFxuICB1c2VBbmltYXRpb25cbn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XG5pbXBvcnQgeyBLZXkgfSBmcm9tICcuL2tleWNvZGVzLmVudW0nO1xuaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgTmF2aWdhdGVhYmxlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBGaXZHYWxsZXJ5SW1hZ2UgfSBmcm9tICcuL2dhbGxlcnktaW1hZ2UvZ2FsbGVyeS1pbWFnZS5jb21wb25lbnQnO1xuaW1wb3J0IHsgZnJvbSwgU3ViamVjdCwgemlwLCBvZiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWVyZ2VNYXAsIHRha2VVbnRpbCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHtcbiAgdHdlZW4sXG4gIGZyb21UbyxcbiAgZ2V0UG9zaXRpb24sXG4gIHNldFBvc2l0aW9uLFxuICBSZWN0UG9zaXRpb24sXG4gIGZyb21Ub1BpeGVscyxcbiAgZWFzZU91dFNpbmVcbn0gZnJvbSAnQGZpdmV0aHJlZS9uZ3gtcnhqcy1hbmltYXRpb25zJztcbmltcG9ydCB7IGZhZGUgfSBmcm9tICcuLi9hbmltYXRpb25zL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHsgSW1hZ2VTZXJ2aWNlIH0gZnJvbSAnLi9pbWFnZS5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZml2LWdhbGxlcnknLFxuICB0ZW1wbGF0ZVVybDogJy4vZ2FsbGVyeS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2dhbGxlcnkuY29tcG9uZW50LnNjc3MnXSxcbiAgYW5pbWF0aW9uczogW1xuICAgIHRyaWdnZXIoJ3NjYWxlJywgW1xuICAgICAgdHJhbnNpdGlvbigndm9pZCA9PiAqJywgW1xuICAgICAgICBzdHlsZSh7IG9wYWNpdHk6IDAsIHRyYW5zZm9ybTogJ3NjYWxlKDApJyB9KSxcbiAgICAgICAgYW5pbWF0ZSgnMTI1bXMnLCBzdHlsZSh7IG9wYWNpdHk6IDEsIHRyYW5zZm9ybTogJ3NjYWxlKDEpJyB9KSlcbiAgICAgIF0pLFxuICAgICAgdHJhbnNpdGlvbignKiA9PiB2b2lkJywgW1xuICAgICAgICBzdHlsZSh7IG9wYWNpdHk6IDEsIHRyYW5zZm9ybTogJ3NjYWxlKDEpJyB9KSxcbiAgICAgICAgYW5pbWF0ZSgnMTI1bXMnLCBzdHlsZSh7IG9wYWNpdHk6IDAsIHRyYW5zZm9ybTogJ3NjYWxlKDApJyB9KSlcbiAgICAgIF0pXG4gICAgXSksXG4gICAgdHJpZ2dlcignc2xpZGVVcCcsIFtcbiAgICAgIHRyYW5zaXRpb24oJ3ZvaWQgPT4gKicsIFtcbiAgICAgICAgc3R5bGUoeyBvcGFjaXR5OiAwLCB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKDEwMCUpJyB9KSxcbiAgICAgICAgYW5pbWF0ZSgnNzVtcycsIHN0eWxlKHsgb3BhY2l0eTogMSwgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwJSknIH0pKVxuICAgICAgXSksXG4gICAgICB0cmFuc2l0aW9uKCcqID0+IHZvaWQnLCBbXG4gICAgICAgIHN0eWxlKHsgb3BhY2l0eTogMSwgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwJSknIH0pLFxuICAgICAgICBhbmltYXRlKCc3NW1zJywgc3R5bGUoeyBvcGFjaXR5OiAwLCB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKDEwMCUpJyB9KSlcbiAgICAgIF0pXG4gICAgXSksXG4gICAgdHJpZ2dlcignc2xpZGVEb3duJywgW1xuICAgICAgdHJhbnNpdGlvbignKiA9PiB2b2lkJywgW1xuICAgICAgICBzdHlsZSh7IG9wYWNpdHk6IDAsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoMCUpJyB9KSxcbiAgICAgICAgYW5pbWF0ZSgnNzVtcycsIHN0eWxlKHsgb3BhY2l0eTogMSwgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgtMTAwJSknIH0pKVxuICAgICAgXSksXG4gICAgICB0cmFuc2l0aW9uKCd2b2lkID0+IConLCBbXG4gICAgICAgIHN0eWxlKHsgb3BhY2l0eTogMSwgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgtMTAwJSknIH0pLFxuICAgICAgICBhbmltYXRlKCc3NW1zJywgc3R5bGUoeyBvcGFjaXR5OiAwLCB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKDAlKScgfSkpXG4gICAgICBdKVxuICAgIF0pLFxuICAgIHRyaWdnZXIoJ2ZhZGUnLCBbXG4gICAgICB0cmFuc2l0aW9uKFxuICAgICAgICAnKiA9PiB2b2lkJyxcbiAgICAgICAgdXNlQW5pbWF0aW9uKGZhZGUsIHtcbiAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgIGZyb21PcGFjaXR5OiAxLFxuICAgICAgICAgICAgdG9PcGFjaXR5OiAwLFxuICAgICAgICAgICAgdGltZTogJzI0MG1zJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICksXG4gICAgICB0cmFuc2l0aW9uKFxuICAgICAgICAndm9pZCA9PiAqJyxcbiAgICAgICAgdXNlQW5pbWF0aW9uKGZhZGUsIHtcbiAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgIGZyb21PcGFjaXR5OiAwLFxuICAgICAgICAgICAgdG9PcGFjaXR5OiAxLFxuICAgICAgICAgICAgdGltZTogJzI0MG1zJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIClcbiAgICBdKVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIEZpdkdhbGxlcnkgaW1wbGVtZW50cyBBZnRlckNvbnRlbnRJbml0LCBPbkRlc3Ryb3ksIE5hdmlnYXRlYWJsZSB7XG4gIEBWaWV3Q2hpbGQoJ292ZXJsYXknLCB7IHN0YXRpYzogZmFsc2UgfSkgb3ZlcmxheTogRml2T3ZlcmxheTtcbiAgQFZpZXdDaGlsZCgnbW9ycGhPdmVybGF5JywgeyBzdGF0aWM6IGZhbHNlIH0pIG1vcnBoT3ZlcmxheTogRml2T3ZlcmxheTtcbiAgQFZpZXdDaGlsZCgndmlld2VyJywgeyBzdGF0aWM6IGZhbHNlIH0pIHZpZXdlcjogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnbW9ycGgnLCB7IHN0YXRpYzogZmFsc2UgfSkgbW9ycGhJbWFnZTogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnc2xpZGVyJywgeyBzdGF0aWM6IGZhbHNlLCByZWFkOiBFbGVtZW50UmVmIH0pIHN3aXBlcjogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnc2xpZGVyJywgeyBzdGF0aWM6IGZhbHNlIH0pIHNsaWRlczogSW9uU2xpZGVzO1xuICBAVmlld0NoaWxkcmVuKCdzbGlkZUltYWdlJykgc2xpZGVJbWFnZXM6IFF1ZXJ5TGlzdDxFbGVtZW50UmVmPjtcblxuICBAQ29udGVudENoaWxkcmVuKFxuICAgIGZvcndhcmRSZWYoKCkgPT4gRml2R2FsbGVyeUltYWdlKSxcbiAgICB7IGRlc2NlbmRhbnRzOiB0cnVlIH1cbiAgKVxuICBpbWFnZXM6IFF1ZXJ5TGlzdDxGaXZHYWxsZXJ5SW1hZ2U+O1xuICBAQ29udGVudENoaWxkcmVuKEZpdkdhbGxlcnlUb29sYmFyKSB0b29sYmFyczogUXVlcnlMaXN0PEZpdkdhbGxlcnlUb29sYmFyPjtcblxuICB0b3BUb29sYmFyOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBib3R0b21Ub29sYmFyOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gIC8vIHByb3BlcnRpZXMgZm9yIHRoZSBzbGlkZXNcbiAgaW5pdGlhbEltYWdlOiBGaXZHYWxsZXJ5SW1hZ2U7XG4gIGFjdGl2ZUluZGV4ID0gMDtcbiAgaW5GdWxsc2NyZWVuID0gZmFsc2U7XG4gIHpvb21lZEluID0gZmFsc2U7XG4gIGNvbnRyb2xzVmlzaWJsZSA9IHRydWU7XG4gIHNsaWRlc0xvYWRlZCA9IGZhbHNlO1xuICBtb3JwaGluZyA9IGZhbHNlO1xuICBiYWNrZHJvcCA9IGZhbHNlO1xuICBiYWNrZHJvcENvbG9yID0gJyMwMDAwMDBlZSc7XG5cbiAgQElucHV0KCkgcGFnZXJWaXNpYmxlID0gdHJ1ZTtcbiAgQElucHV0KCkgYW1iaWVudCA9IGZhbHNlO1xuXG4gIEBPdXRwdXQoKSB3aWxsT3BlbiA9IG5ldyBFdmVudEVtaXR0ZXI8Rml2R2FsbGVyeUltYWdlPigpO1xuICBAT3V0cHV0KCkgd2lsbENsb3NlID0gbmV3IEV2ZW50RW1pdHRlcjxGaXZHYWxsZXJ5SW1hZ2U+KCk7XG4gIEBPdXRwdXQoKSBkaWRPcGVuID0gbmV3IEV2ZW50RW1pdHRlcjxGaXZHYWxsZXJ5SW1hZ2U+KCk7XG4gIEBPdXRwdXQoKSBkaWRDbG9zZSA9IG5ldyBFdmVudEVtaXR0ZXI8Rml2R2FsbGVyeUltYWdlPigpO1xuICBAT3V0cHV0KCkgYmFja2Ryb3BDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPEZpdkdhbGxlcnlJbWFnZT4oKTtcblxuICAkb25EZXN0cm95ID0gbmV3IFN1YmplY3QoKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGRvbUN0cmw6IERvbUNvbnRyb2xsZXIsXG4gICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLFxuICAgIHByaXZhdGUgYW5pbWF0aW9uOiBBbmltYXRpb25CdWlsZGVyLFxuICAgIHByaXZhdGUgY2hhbmdlOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBwcml2YXRlIHBsYXRmb3JtOiBQbGF0Zm9ybSxcbiAgICBwcml2YXRlIGltYWdlU2VydmljZTogSW1hZ2VTZXJ2aWNlLFxuICAgIEBJbmplY3QoRE9DVU1FTlQpIHByaXZhdGUgZG9jdW1lbnQ6IGFueVxuICApIHt9XG5cbiAgbmdBZnRlckNvbnRlbnRJbml0KCk6IHZvaWQge1xuICAgIHRoaXMudXBkYXRlSW1hZ2VzSW5kZXgoKTtcbiAgICB0aGlzLnNldHVwVG9vbGJhcnMoKTtcbiAgICB0aGlzLnN1YnNjcmliZVRvSW1hZ2VFdmVudHMoKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuJG9uRGVzdHJveS5uZXh0KCk7XG4gIH1cblxuICBzdWJzY3JpYmVUb0ltYWdlRXZlbnRzKCkge1xuICAgIGZyb20odGhpcy5pbWFnZXMubWFwKGltYWdlID0+IGltYWdlLmNsaWNrKSlcbiAgICAgIC5waXBlKFxuICAgICAgICBtZXJnZU1hcCgodmFsdWU6IEV2ZW50RW1pdHRlcjxGaXZHYWxsZXJ5SW1hZ2U+KSA9PiB2YWx1ZSksXG4gICAgICAgIHRha2VVbnRpbDxGaXZHYWxsZXJ5SW1hZ2U+KHRoaXMuJG9uRGVzdHJveSlcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoaW1hZ2UgPT4ge1xuICAgICAgICB0aGlzLm9wZW4oaW1hZ2UpO1xuICAgICAgfSk7XG4gIH1cblxuICB1cGRhdGVJbWFnZXNJbmRleCgpIHtcbiAgICB0aGlzLmltYWdlcy5mb3JFYWNoKChpbWcsIGkpID0+IHtcbiAgICAgIGltZy5pbmRleCA9IGk7XG4gICAgfSk7XG4gIH1cblxuICBzZXR1cFRvb2xiYXJzKCkge1xuICAgIHRoaXMudG9vbGJhcnMuZm9yRWFjaCh0b29sYmFyID0+IHtcbiAgICAgIGlmICh0b29sYmFyLnBvc2l0aW9uID09PSAndG9wJykge1xuICAgICAgICB0aGlzLnRvcFRvb2xiYXIgPSB0b29sYmFyLmNvbnRlbnQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmJvdHRvbVRvb2xiYXIgPSB0b29sYmFyLmNvbnRlbnQ7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBvcGVuKGluaXRpYWw6IEZpdkdhbGxlcnlJbWFnZSkge1xuICAgIHRoaXMud2lsbE9wZW4uZW1pdChpbml0aWFsKTtcbiAgICB0aGlzLmFjdGl2ZUluZGV4ID0gaW5pdGlhbC5pbmRleDtcbiAgICB0aGlzLm1vcnBoaW5nID0gdHJ1ZTtcbiAgICB0aGlzLm92ZXJsYXkuc2hvdyg1MDAwMCk7XG4gICAgdGhpcy5pbml0aWFsSW1hZ2UgPSBpbml0aWFsO1xuICAgIHRoaXMudXBkYXRlQmFja2Ryb3AodGhpcy5hY3RpdmVJbmRleCk7XG4gICAgdGhpcy5pbml0aWFsSW1hZ2Uub3JpZ2luYWxTcmMgPSBpbml0aWFsLnNyYztcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIC8vd2FpdCBhIGxpdHRsZSBmb3IgcmlwcGxlXG4gICAgICB0aGlzLmJhY2tkcm9wID0gdHJ1ZTtcbiAgICAgIHRoaXMuc2hvd0NvbnRyb2xzKCk7XG4gICAgICB0aGlzLm1vcnBoSW4oKTtcbiAgICB9LCAzMDApO1xuICB9XG5cbiAgbW9ycGhJbigpIHtcbiAgICB0aGlzLm1vcnBoT3ZlcmxheS5zaG93KDQ5OTk5KTtcbiAgICBjb25zdCBmID0gZ2V0UG9zaXRpb24odGhpcy5pbml0aWFsSW1hZ2UudGh1bWJuYWlsKTtcbiAgICBjb25zdCB0ID0gdGhpcy5jYWxjdWxhdGVJbWFnZVBvc2l0aW9uKCk7XG4gICAgY29uc3QgdHdlZW5Eb25lID0gbmV3IFN1YmplY3QoKTtcbiAgICB0d2VlbihlYXNlT3V0U2luZSwgMzIwKVxuICAgICAgLnBpcGUoXG4gICAgICAgIGZyb21Ub1BpeGVscyh0aGlzLm1vcnBoSW1hZ2UsIGYudG9wLCB0LnRvcCwgJ3RvcCcpLFxuICAgICAgICBmcm9tVG9QaXhlbHModGhpcy5tb3JwaEltYWdlLCBmLmxlZnQsIHQubGVmdCwgJ2xlZnQnKSxcbiAgICAgICAgZnJvbVRvUGl4ZWxzKHRoaXMubW9ycGhJbWFnZSwgZi5oZWlnaHQsIHQuaGVpZ2h0LCAnaGVpZ2h0JyksXG4gICAgICAgIGZyb21Ub1BpeGVscyh0aGlzLm1vcnBoSW1hZ2UsIGYud2lkdGgsIHQud2lkdGgsICd3aWR0aCcpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKHtcbiAgICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgICB0d2VlbkRvbmUubmV4dCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIHppcCh0d2VlbkRvbmUsICF0aGlzLnNsaWRlc0xvYWRlZCA/IHRoaXMuc2xpZGVzLmlvblNsaWRlc0RpZExvYWQgOiBvZih0cnVlKSlcbiAgICAgIC5waXBlKFxuICAgICAgICB0YXAoKCkgPT4ge1xuICAgICAgICAgIHRoaXMubW9ycGhpbmcgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLm1vcnBoT3ZlcmxheS5oaWRlKCk7XG4gICAgICAgICAgdGhpcy5kaWRPcGVuLmVtaXQodGhpcy5pbml0aWFsSW1hZ2UpO1xuICAgICAgICAgIHRoaXMuc3dpcGVyLm5hdGl2ZUVsZW1lbnQuc3dpcGVyLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlU2luZ2xlVGFwKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pLFxuICAgICAgICB0YWtlVW50aWwodGhpcy4kb25EZXN0cm95KVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgpO1xuICB9XG5cbiAgZGlzbWlzcygpIHtcbiAgICB0aGlzLmNsb3NlKGZhbHNlKTtcbiAgfVxuXG4gIGNsb3NlKGVtaXQgPSB0cnVlKSB7XG4gICAgaWYgKGVtaXQpIHtcbiAgICAgIHRoaXMud2lsbENsb3NlLmVtaXQodGhpcy5pbml0aWFsSW1hZ2UpO1xuICAgIH1cbiAgICB0aGlzLmJhY2tkcm9wID0gZmFsc2U7XG4gICAgY29uc3Qgc2FtZUFzSW5pdGlhbCA9XG4gICAgICB0aGlzLmltYWdlcy50b0FycmF5KClbdGhpcy5hY3RpdmVJbmRleF0uaW5kZXggPT09IHRoaXMuaW5pdGlhbEltYWdlLmluZGV4O1xuICAgIGlmIChzYW1lQXNJbml0aWFsKSB7XG4gICAgICB0aGlzLm1vcnBoQmFjaygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNsaWRlT3V0KCk7XG4gICAgfVxuICAgIHRoaXMucmVzZXRTbGlkZXMoMCk7XG4gICAgaWYgKHRoaXMuaW5GdWxsc2NyZWVuKSB7XG4gICAgICB0aGlzLmNsb3NlRnVsbHNjcmVlbigpO1xuICAgIH1cbiAgICB0aGlzLnNsaWRlc0xvYWRlZCA9IGZhbHNlO1xuICB9XG5cbiAgbW9ycGhCYWNrKCkge1xuICAgIGNvbnN0IGYgPSBnZXRQb3NpdGlvbih0aGlzLmdldEFjdGl2ZUltYWdlKCkpO1xuICAgIGNvbnN0IHQgPSBnZXRQb3NpdGlvbih0aGlzLmluaXRpYWxJbWFnZS50aHVtYm5haWwpO1xuICAgIHRoaXMub3ZlcmxheS5oaWRlKCk7XG4gICAgdGhpcy5tb3JwaE92ZXJsYXkuc2hvdygpO1xuICAgIHR3ZWVuKGVhc2VPdXRTaW5lLCAyNDApXG4gICAgICAucGlwZShcbiAgICAgICAgZnJvbVRvUGl4ZWxzKHRoaXMubW9ycGhJbWFnZSwgZi50b3AsIHQudG9wLCAndG9wJyksXG4gICAgICAgIGZyb21Ub1BpeGVscyh0aGlzLm1vcnBoSW1hZ2UsIGYubGVmdCwgdC5sZWZ0LCAnbGVmdCcpLFxuICAgICAgICBmcm9tVG9QaXhlbHModGhpcy5tb3JwaEltYWdlLCBmLmhlaWdodCwgdC5oZWlnaHQsICdoZWlnaHQnKSxcbiAgICAgICAgZnJvbVRvUGl4ZWxzKHRoaXMubW9ycGhJbWFnZSwgZi53aWR0aCwgdC53aWR0aCwgJ3dpZHRoJylcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoe1xuICAgICAgICBjb21wbGV0ZTogKCkgPT4ge1xuICAgICAgICAgIHRoaXMubW9ycGhPdmVybGF5LmhpZGUoKTtcbiAgICAgICAgICB0aGlzLmRpZENsb3NlLmVtaXQodGhpcy5pbml0aWFsSW1hZ2UpO1xuICAgICAgICAgIHRoaXMuaW5pdGlhbEltYWdlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cblxuICBzbGlkZU91dCgpIHtcbiAgICB0aGlzLm92ZXJsYXkuaGlkZSgpO1xuICAgIHRoaXMubW9ycGhPdmVybGF5LnNob3coKTtcbiAgICB0aGlzLm1vcnBoSW1hZ2UubmF0aXZlRWxlbWVudC5zcmMgPSB0aGlzLmdldEFjdGl2ZUltYWdlKCkubmF0aXZlRWxlbWVudC5zcmM7XG4gICAgc2V0UG9zaXRpb24odGhpcy5tb3JwaEltYWdlLCBnZXRQb3NpdGlvbih0aGlzLmdldEFjdGl2ZUltYWdlKCkpKTtcbiAgICB0d2VlbihlYXNlT3V0U2luZSwgMjQwKVxuICAgICAgLnBpcGUoXG4gICAgICAgIGZyb21UbyhcbiAgICAgICAgICB0aGlzLm1vcnBoSW1hZ2UsXG4gICAgICAgICAgJ3RyYW5zZm9ybScsXG4gICAgICAgICAgMCxcbiAgICAgICAgICAxMDAsXG4gICAgICAgICAgKHQ6IG51bWJlcikgPT4gYHRyYW5zbGF0ZVkoJHt0fSUpYFxuICAgICAgICApXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKHtcbiAgICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgICB0aGlzLm1vcnBoSW1hZ2UubmF0aXZlRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSAnJztcbiAgICAgICAgICB0aGlzLm1vcnBoT3ZlcmxheS5oaWRlKCk7XG4gICAgICAgICAgdGhpcy5kaWRDbG9zZS5lbWl0KHRoaXMuaW5pdGlhbEltYWdlKTtcbiAgICAgICAgICB0aGlzLmluaXRpYWxJbWFnZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0QWN0aXZlSW1hZ2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2xpZGVJbWFnZXMudG9BcnJheSgpW3RoaXMuYWN0aXZlSW5kZXhdO1xuICB9XG5cbiAgdHJhbnNmb3JtU2xpZGVzKHByb2dyZXNzOiBudW1iZXIpIHtcbiAgICBpZiAodGhpcy5jb250cm9sc1Zpc2libGUpIHtcbiAgICAgIHRoaXMuaGlkZUNvbnRyb2xzKCk7XG4gICAgfVxuICAgIHRoaXMuZG9tQ3RybC53cml0ZSgoKSA9PiB7XG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICB0aGlzLnZpZXdlci5uYXRpdmVFbGVtZW50LFxuICAgICAgICAndHJhbnNmb3JtJyxcbiAgICAgICAgYHRyYW5zbGF0ZVkoJHtwcm9ncmVzcyAqIDEyMH1weClgXG4gICAgICApO1xuICAgIH0pO1xuICB9XG5cbiAgcmVzZXRTbGlkZXMocHJvZ3Jlc3M6IG51bWJlcikge1xuICAgIGNvbnN0IHJlc2V0ID0gdGhpcy5hbmltYXRpb24uYnVpbGQoW1xuICAgICAgc3R5bGUoeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cHJvZ3Jlc3MgKiAxMjB9cHgpYCB9KSxcbiAgICAgIGFuaW1hdGUoJzE1MG1zJywgc3R5bGUoeyB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKDBweClgIH0pKVxuICAgIF0pO1xuXG4gICAgY29uc3QgYW5pbWF0aW9uID0gcmVzZXQuY3JlYXRlKHRoaXMudmlld2VyLm5hdGl2ZUVsZW1lbnQpO1xuICAgIGFuaW1hdGlvbi5wbGF5KCk7XG4gICAgYW5pbWF0aW9uLm9uRG9uZSgoKSA9PiB7XG4gICAgICBhbmltYXRpb24uZGVzdHJveSgpO1xuICAgICAgdGhpcy50cmFuc2Zvcm1TbGlkZXMoMCk7XG4gICAgICB0aGlzLnNob3dDb250cm9scygpO1xuICAgIH0pO1xuICB9XG5cbiAgc2xpZGVEaWRDaGFuZ2UoKSB7XG4gICAgdGhpcy5hY3RpdmVJbmRleCA9IHRoaXMuc3dpcGVyLm5hdGl2ZUVsZW1lbnQuc3dpcGVyLmFjdGl2ZUluZGV4O1xuICB9XG5cbiAgaW9uU2xpZGVOZXh0U3RhcnQoKSB7XG4gICAgaWYgKHRoaXMuc2xpZGVzTG9hZGVkKSB7XG4gICAgICB0aGlzLnVwZGF0ZUJhY2tkcm9wKHRoaXMuYWN0aXZlSW5kZXggKyAxKTtcbiAgICB9XG4gIH1cbiAgaW9uU2xpZGVQcmV2U3RhcnQoKSB7XG4gICAgaWYgKHRoaXMuc2xpZGVzTG9hZGVkKSB7XG4gICAgICB0aGlzLnVwZGF0ZUJhY2tkcm9wKHRoaXMuYWN0aXZlSW5kZXggLSAxKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVCYWNrZHJvcChpbmRleDogbnVtYmVyKSB7XG4gICAgdGhpcy5iYWNrZHJvcENvbG9yID0gdGhpcy5hbWJpZW50XG4gICAgICA/IHRoaXMuaW1hZ2VTZXJ2aWNlLmdldEF2ZXJhZ2VSR0IoXG4gICAgICAgICAgdGhpcy5pbWFnZXMudG9BcnJheSgpW2luZGV4XS50aHVtYm5haWwubmF0aXZlRWxlbWVudFxuICAgICAgICApXG4gICAgICA6ICcjMDAwMDAwZWUnO1xuXG4gICAgdGhpcy5iYWNrZHJvcENoYW5nZS5lbWl0KCk7XG4gIH1cblxuICBvblNsaWRlc0xvYWQoKSB7XG4gICAgdGhpcy5zbGlkZXNMb2FkZWQgPSB0cnVlO1xuICB9XG4gIGNhbGN1bGF0ZUltYWdlUG9zaXRpb24oKTogUmVjdFBvc2l0aW9uIHtcbiAgICBjb25zdCBuSCA9IHRoaXMuaW5pdGlhbEltYWdlLnRodW1ibmFpbC5uYXRpdmVFbGVtZW50Lm5hdHVyYWxIZWlnaHQ7XG4gICAgY29uc3QgblcgPSB0aGlzLmluaXRpYWxJbWFnZS50aHVtYm5haWwubmF0aXZlRWxlbWVudC5uYXR1cmFsV2lkdGg7XG4gICAgbGV0IGhlaWdodCA9IE1hdGgubWluKG5ILCB0aGlzLnBsYXRmb3JtLmhlaWdodCgpKTtcbiAgICBsZXQgd2lkdGggPSBNYXRoLm1pbihuVywgdGhpcy5wbGF0Zm9ybS53aWR0aCgpKTtcbiAgICBjb25zdCByYXRpbyA9IG5XIC8gbkg7XG4gICAgaWYgKHJhdGlvICogaGVpZ2h0IDwgd2lkdGgpIHtcbiAgICAgIHdpZHRoID0gaGVpZ2h0ICogcmF0aW87XG4gICAgfSBlbHNlIHtcbiAgICAgIGhlaWdodCA9IHdpZHRoIC8gcmF0aW87XG4gICAgfVxuXG4gICAgY29uc3QgdG9wID0gdGhpcy5wbGF0Zm9ybS5oZWlnaHQoKSAvIDIgLSBoZWlnaHQgLyAyO1xuICAgIGNvbnN0IGxlZnQgPSB0aGlzLnBsYXRmb3JtLndpZHRoKCkgLyAyIC0gd2lkdGggLyAyO1xuICAgIGNvbnN0IHAgPSB7XG4gICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICB0b3A6IHRvcFxuICAgIH07XG4gICAgcmV0dXJuIHA7XG4gIH1cblxuICBmdWxsc2NyZWVuKCkge1xuICAgIGlmICh0aGlzLmluRnVsbHNjcmVlbikge1xuICAgICAgdGhpcy5jbG9zZUZ1bGxzY3JlZW4oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vcGVuRnVsbHNjcmVlbigpO1xuICAgIH1cbiAgfVxuXG4gIG9wZW5GdWxsc2NyZWVuKCkge1xuICAgIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgaWYgKGVsZW0ucmVxdWVzdEZ1bGxzY3JlZW4pIHtcbiAgICAgIGVsZW0ucmVxdWVzdEZ1bGxzY3JlZW4oKTtcbiAgICB9IGVsc2UgaWYgKGVsZW1bJ21velJlcXVlc3RGdWxsU2NyZWVuJ10pIHtcbiAgICAgIC8qIEZpcmVmb3ggKi9cbiAgICAgIGVsZW1bJ21velJlcXVlc3RGdWxsU2NyZWVuJ10oKTtcbiAgICB9IGVsc2UgaWYgKGVsZW1bJ3dlYmtpdFJlcXVlc3RGdWxsc2NyZWVuJ10pIHtcbiAgICAgIC8qIENocm9tZSwgU2FmYXJpIGFuZCBPcGVyYSAqL1xuICAgICAgZWxlbVsnd2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4nXSgpO1xuICAgIH0gZWxzZSBpZiAoZWxlbVsnbXNSZXF1ZXN0RnVsbHNjcmVlbiddKSB7XG4gICAgICAvKiBJRS9FZGdlICovXG4gICAgICBlbGVtWydtc1JlcXVlc3RGdWxsc2NyZWVuJ10oKTtcbiAgICB9XG4gICAgdGhpcy5pbkZ1bGxzY3JlZW4gPSB0cnVlO1xuICB9XG5cbiAgY2xvc2VGdWxsc2NyZWVuKCkge1xuICAgIHRoaXMuaW5GdWxsc2NyZWVuID0gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5kb2N1bWVudC5leGl0RnVsbHNjcmVlbikge1xuICAgICAgdGhpcy5kb2N1bWVudC5leGl0RnVsbHNjcmVlbigpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5kb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuKSB7XG4gICAgICAvKiBGaXJlZm94ICovXG4gICAgICB0aGlzLmRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4oKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4pIHtcbiAgICAgIC8qIENocm9tZSwgU2FmYXJpIGFuZCBPcGVyYSAqL1xuICAgICAgdGhpcy5kb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbigpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5kb2N1bWVudC5tc0V4aXRGdWxsc2NyZWVuKSB7XG4gICAgICAvKiBJRS9FZGdlICovXG4gICAgICB0aGlzLmRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW4oKTtcbiAgICB9XG4gIH1cblxuICB6b29tKCkge1xuICAgIGlmICh0aGlzLnpvb21lZEluKSB7XG4gICAgICB0aGlzLnpvb21PdXQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy56b29tSW4oKTtcbiAgICB9XG4gIH1cblxuICB6b29tSW4oKSB7XG4gICAgdGhpcy5zd2lwZXIubmF0aXZlRWxlbWVudC5zd2lwZXIuem9vbS5pbigpO1xuICAgIHRoaXMuem9vbWVkSW4gPSB0cnVlO1xuICB9XG5cbiAgem9vbU91dCgpIHtcbiAgICB0aGlzLnN3aXBlci5uYXRpdmVFbGVtZW50LnN3aXBlci56b29tLm91dCgpO1xuICAgIHRoaXMuem9vbWVkSW4gPSBmYWxzZTtcbiAgfVxuXG4gIGhhbmRsZVNpbmdsZVRhcCgpIHtcbiAgICB0aGlzLmNvbnRyb2xzVmlzaWJsZSA9ICF0aGlzLmNvbnRyb2xzVmlzaWJsZTtcbiAgICB0aGlzLmNoYW5nZS5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICBoaWRlQ29udHJvbHMoKSB7XG4gICAgdGhpcy5jb250cm9sc1Zpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLmNoYW5nZS5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICBzaG93Q29udHJvbHMoKSB7XG4gICAgdGhpcy5jb250cm9sc1Zpc2libGUgPSB0cnVlO1xuICAgIHRoaXMuY2hhbmdlLmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzprZXl1cCcsIFsnJGV2ZW50J10pXG4gIGtleUV2ZW50KGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgaWYgKHRoaXMuc2xpZGVzTG9hZGVkICYmICF0aGlzLm1vcnBoaW5nKSB7XG4gICAgICB0aGlzLmhhbmRsZUtleWJvYXJkRXZlbnRzKGV2ZW50KTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVLZXlib2FyZEV2ZW50cyhldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgIGlmIChldmVudC5rZXkgPT09ICdBcnJvd1JpZ2h0Jykge1xuICAgICAgdGhpcy5uZXh0KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChldmVudC5rZXkgPT09ICdBcnJvd0xlZnQnKSB7XG4gICAgICB0aGlzLnByZXYoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicgfHwgZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIG5leHQoKSB7XG4gICAgaWYgKHRoaXMuc2xpZGVzICYmIHRoaXMuc2xpZGVzTG9hZGVkKSB7XG4gICAgICB0aGlzLnNsaWRlcy5zbGlkZU5leHQoKTtcbiAgICB9XG4gIH1cbiAgcHJldigpIHtcbiAgICBpZiAodGhpcy5zbGlkZXMgJiYgdGhpcy5zbGlkZXNMb2FkZWQpIHtcbiAgICAgIHRoaXMuc2xpZGVzLnNsaWRlUHJldigpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUG9zaXRpb24ge1xuICB0b3A6IG51bWJlcjtcbiAgbGVmdDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgd2lkdGg6IG51bWJlcjtcbiAgdHJhbnNsYXRlPzogbnVtYmVyO1xufVxuIl19